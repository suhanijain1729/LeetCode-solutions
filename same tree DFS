class Solution(object):
    def isSameTree(self, p, q):
        """
        :type p: TreeNode
        :type q: TreeNode
        :rtype: bool
        """
        pStack = []
        qStack = []
        while p or pStack or q or qStack:
            while p:
                pStack.append(p)
                p = p.left
            while q:
                qStack.append(q)
                q = q.left
            if len(pStack) != len(qStack):
                return False
            pNode = pStack.pop()
            qNode = qStack.pop()
            if pNode.val != qNode.val:
                return False
            p = pNode.right
            q = qNode.right
        return True
